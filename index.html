<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .user-message {
            color: blue;
            text-align: left;
        }

        .bot-message {
            color: green;
            text-align: right;
        }
    </style>
</head>

<body class="bg-gray-200">
    <!-- Parent container -->
    <div class="parent-container bg-white border rounded-md border-gray-300 mx-auto max-w-3xl my-8 p-4">
        <!-- Header section -->
        <div class="header bg-blue-500 text-white py-2 px-4 flex items-center">
            <img src="images/sterlinglogo.png" alt="logo" class="w-10 h-10 rounded-full">
            <div class="online-indicator w-4 h-4 bg-green-500 rounded-full mr-2"></div>
            <div class="header-text text-lg">
                Chat with Us <span class="text-sm">Here we are online</span>
            </div>
        </div>

        <div class="container px-4 pt-4">
            <div class="chat-container bg-white border-t border-b border-gray-300 p-2 h-96 overflow-y-auto">
                <!-- Chat messages will be displayed here -->
            </div>
            <div class="input-container flex items-center border-t border-gray-300 pt-6">
                <form id="chat-form" class="flex-1 flex">
                    <input type="text" id="user-input" placeholder="Type your question..." class="p-2 text-lg border-none focus:outline-none placeholder-gray-500 text-gray-900" oninput="clearPlaceholder()">
                    <div class="flex-grow"></div> <!-- This will push the button to the right -->
                    <button type="submit" class="px-4 py-2 text-lg bg-blue-500 text-white rounded-md cursor-pointer">Send</button>
                </form>
            </div>
        </div>

        <script>
            // Function to send user input to Flask backend
            function sendUserInput(userInput) {
                // Clear placeholder text
                document.getElementById("user-input").value = "";

                // Display user input
                displayMessage(userInput, "user-message");

                // Create a new XMLHttpRequest object
                var xhr = new XMLHttpRequest();

                // Configure the request
                xhr.open("POST", "/chat");
                xhr.setRequestHeader("Content-Type", "application/json");

                // Define the callback function to handle the response
                xhr.onload = function () {
                    if (xhr.status === 200) {
                        // Parse the JSON response
                        var response = JSON.parse(xhr.responseText);
                        // Display the bot response
                        displayMessage(response.bot_response, "bot-message");
                    } else {
                        console.error("Error:", xhr.statusText);
                    }
                };

                // Create a JSON object with the user input
                var data = JSON.stringify({ "user_input": userInput });

                // Send the request with the user input
                xhr.send(data);
            }

            // Update the sendMessage function to handle form submission
            document.getElementById("chat-form").addEventListener("submit", function (event) {
                event.preventDefault(); // Prevent form submission

                // Get user input
                var userInput = document.getElementById("user-input").value;

                // Send user input to Flask backend
                sendUserInput(userInput);
            });

            // Function to display messages in the chat container
            function displayMessage(message, messageClass) {
                var chatContainer = document.querySelector(".chat-container");
                var messageElement = document.createElement("div");
                messageElement.classList.add("chat-message", messageClass);
                messageElement.innerHTML = message;
                chatContainer.appendChild(messageElement);
                // Scroll to bottom of chat container
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
        </script>

</body>

</html>
